(function (e) { e.linkselect = { version: "1.5.10" }; e.fn.linkselect = function (t) { var n = typeof arguments[0] == "string" && arguments[0]; var r = n && Array.prototype.slice.call(arguments, 1) || arguments; if (n && this.length) { var i = e.data(this[0], "linkselect"); if (n.toLowerCase() == "object") return i; else if (i[n]) { var s; this.each(function (t) { var o = e.data(this, "linkselect")[n].apply(i, r); if (t == 0 && o) { if (!!o.jquery) { s = e([]).add(o) } else { s = o; return false } } else if (!!o && !!o.jquery) { s = s.add(o) } }); return s || this } else return this } else { return this.each(function () { new e.LinkSelect(this, t) }) } }; var t = 0; e.LinkSelect = function (n, r) { function S() { e(document).bind("click.linkselect-" + s, function (t) { var n = e(t.target); if (n.closest("a")[0] !== v[0] && n[0] !== y[0] && g.is(":visible")) { U(); if (p && n.closest("." + r.classes.title)[0] === b[0]) { L() } var i = n.closest(g); if (i.length) { setTimeout(function () { v.trigger("focus.linkselect") }, 13) } else { v.removeClass(r.classes.linkFocus) } } }); e(window).bind("resize.linkselect-" + s, function () { W(v, g) }) } function x() { e(document).unbind("click.linkselect-" + s); e(window).unbind("resize.linkselect-" + s) } function T() { var t = i.id, n = u.attr("name") || t, s = o.selectedIndex == -1 ? "" : o[o.selectedIndex].text, a = o.selectedIndex == -1 ? "" : o[o.selectedIndex][e.browser.msie && e.browser.version <= 7 && !o[o.selectedIndex].attributes["value"].specified ? "text" : "value"], f = u.attr("tabindex"); var l = ['<a href="#' + i.id + '" id="' + i.id + '_link" class="' + e.trim(r.classes.link + " " + r.classLink) + '"' + (f ? ' tabindex="' + f + '"' : "") + ' data-msg-default="' + u.attr("data-msg-default") + '" style="width: ' + u.css("width") + ';">', '<span class="' + r.classes.linkText + '">', s, "</span>", '<span class="' + r.classes.linkIcon + '"><span></span></span>', "</a>", '<div class="' + r.classes.container + '">', '<div class="' + r.classes.title + '"><span></span></div>', '<div class="' + r.classes.scrollable + '"><ul id="' + i.id + '_list">', N(u.children("option")), "</ul></div>", "</div>"]; return e(l.join("")) } function N(t) { a = [], p = t.filter("." + r.classes.placeholder).eq(0); if (p.length == 0) p = null; var n = []; t.each(function (t) { var s = e(this); var o = s.is(":selected"); var u = e.trim(s.text()); var f = '<span class="' + r.classes.value + '">' + u + "</span>"; var l = e.browser.msie && e.browser.version <= 7 && !this.attributes["value"].specified ? this.text : this.value; if (e.isFunction(r.format)) f = r.format.apply(i, [f, l, u, t, s, r]) || f; if (!p || p[0] !== s[0]) { var c = u.length > 1 ? u.substring(0, 1).toLowerCase() : ""; if (!a[c]) a[c] = []; a[c].push(t) } var h = e.trim(this.className + " " + (o ? r.classes.selected : "")); n.push('<li id="' + i.id + "_li_" + t + '" data-value="' + l + (h.length > 0 ? '" class="' + h : "") + '">' + f + "</li>") }); return n.join("") } function C() { q = false; g[0].style.width = ""; if (b.length) { b[0].style.width = ""; b.css("float", "") } w.html(N(u.children("option"))); if (p) k() } function k() { var t = e.trim(u.attr("title") || p && p.text() || ""); b[t.length ? "show" : "hide"]()[p ? "addClass" : "removeClass"](r.classes.placeholder).find("span").text(t) } function L() { if (p) w.find("li." + r.classes.placeholder).trigger("click.linkselect") } function A(e, t) { var n = w.find("li[data-value='" + e + "']"); if (n.length == 0) n = w.find("li:eq(0)"); return n.trigger("click.linkselect", [true, t]) } function O() { var e = w.find("li." + r.classes.selected); if (e.length == 0) e = w.find("li:eq(0)"); return e } function M() { var e = w.find("li." + r.classes.current); if (e.length == 0) e = O(); return e } function _(e) { g.find("." + r.classes.current).removeClass(r.classes.current); return D(e) } function D(e) { e.addClass(r.classes.current); if (p) { b[e.hasClass(r.classes.placeholder) ? "addClass" : "removeClass"](r.classes.current) } return e } function P(e, t) { var n = M(); var i = parseInt(n.attr("id").replace(/(.+)(_(\d+$))/gi, "$3"), 10); if (p && t !== true && n.hasClass(r.classes.placeholder)) i++; H(i + e, t) } function H(e, t) { var n = g.find("li"), i; if (!n || n.length == 0) return false; var s = M().removeClass(r.classes.current); if (isNaN(e) || e < 0) { e = 0 } else if (e > n.length - 1) { e = n.length - 1 } i = n.eq(e); if (p && t !== true && i.hasClass(r.classes.placeholder)) i = n.eq(e + 1); if (g.is(":visible")) { D(i); F(i) } else { if (s[0] !== i[0]) i.trigger("click.linkselect") } } function B() { H(0) } function j() { H(g.find("li").length - 1) } function F(e, t) { var n = e[0]; var r = y[0]; var i = { pTop: parseInt(y.css("paddingTop"), 10) || 0, pBottom: parseInt(y.css("paddingBottom"), 10) || 0, bTop: parseInt(y.css("borderTopWidth"), 10) || 0, bBottom: parseInt(y.css("borderBottomWidth"), 10) || 0 }; if (n.offsetTop + n.offsetHeight > r.scrollTop + r.clientHeight) { r.scrollTop = e.offset().top + (r.scrollTop - y.offset().top) - (r.clientHeight / (t == true ? 2 : 1) - (e.outerHeight() + i.pBottom)) } else if (n.offsetTop - i.bTop - i.bBottom <= r.scrollTop + i.pTop + i.pBottom) { r.scrollTop = e.offset().top + (r.scrollTop - y.offset().top) - i.pTop } } function I() { var e = g.is(":visible"); if (e) U(); else R(); return e } function R(t) { S(); var n = O(), i = !q; v.removeClass(r.classes.linkFocus).addClass(r.classes.linkOpen); g.show(); if (!q) { var s = false ? v.parent().outerWidth(true) : v.width(); var o = r.fixedWidth ? s : g.width(); if (o < s) o = s; var u = parseInt(y.css("max-height"), 10); if (e.browser.msie && e.browser.version <= 6) { if (u > 0 && y.height() > u) y.height(u) } var a = parseInt("0" + g.css("max-width"), 10); if (a > 0 && o > a) o = s = a; g.width(o); if (e.browser.safari) { var f = g.width(); if (s > f) o = s = f } s = s - ((parseInt(b.css("marginRight"), 10) || 0) - (parseInt(b.css("marginLeft"), 10) || 0)); b.width(s); if (b.outerWidth() > s) b.width(s - (b.outerWidth() - s)); if (r.titleAlign.toLowerCase() == "right" && !r.fixedWidth) b.css("float", "right"); q = true } W(v, g, i); if (!!e.fn.bgIframe) g.bgIframe(); F(n, true); _(n); if (e.isFunction(r.open)) r.open.apply(this, [g, v, n, b]); if (e.isFunction(t)) t.apply(this, [g, v, n, b]); h = true } function U(t) { x(); if (t !== true) v.addClass(r.classes.linkFocus).removeClass(r.classes.linkOpen); g.hide(); if (e.isFunction(r.close)) r.close.apply(this, [g, v, O(), b]); h = false } function z(t) { var n = false; if (t.is(":hidden")) { n = !!t.css("visibility", "hidden").show() } var r = e.extend(t.offset(), { width: t.outerWidth(), height: t.outerHeight(), marginLeft: parseInt(e.css(t[0], "marginLeft", true), 10) || 0, marginRight: parseInt(e.css(t[0], "marginRight", true), 10) || 0, marginTop: parseInt(e.css(t[0], "marginTop", true), 10) || 0, marginBottom: parseInt(e.css(t[0], "marginBottom", true), 10) || 0, paddingLeft: parseInt(e.css(t[0], "paddingLeft", true), 10) || 0, paddingRight: parseInt(e.css(t[0], "paddingRight", true), 10) || 0, borderLeftWidth: parseInt(e.css(t[0], "borderLeftWidth", true), 10) || 0, borderRightWidth: parseInt(e.css(t[0], "borderRightWidth", true), 10) || 0 }); if (r.marginTop < 0) r.top += r.marginTop; if (r.marginLeft < 0) r.left += r.marginLeft; r["bottom"] = r.top + r.height; r["right"] = r.left + r.width; if (n) t.hide().css("visibility", "visible"); return r } function W(e, t, n) { var i = z(e); var s = X(); var o = g.outerWidth() + i.left; if (o > s.x) { var u = i.paddingLeft + i.paddingRight + i.borderLeftWidth + i.borderRightWidth; if (n) b.width(b.width() - u); i.left = i.left + u - g.outerWidth() + b.outerWidth(true) } else { var a = g.width(), f = b.outerWidth(true); if (a > f) b.width(a - (f - b.width())) } t.css({ position: "absolute", top: i[r.yAxis], left: i.left }); return i.bottom } function X() { var t = { scrollLeft: e(window).scrollLeft(), scrollTop: e(window).scrollTop(), width: e("body").width(), height: e("body").height() }; t.x = t.scrollLeft + t.width; t.y = t.scrollTop + t.height; return t } function V(e) { return !("bubbles" in e || "cancelBubble" in e) } r = e.extend({}, e.LinkSelect.defaults, r); if (r.style.length == 0) r.style = e.LinkSelect.defaults.style; r.classes = { link: r.style + "-link", linkText: r.style + "-link-text", linkOpen: r.style + "-link-open", linkIcon: r.style + "-link-icon", linkFocus: r.style + "-link-focus", container: r.style + "-container", selected: r.style + "-selected", current: r.style + "-current", disabled: r.style + "-disabled", scrollable: r.style + "-scrollable", title: r.style + "-title", value: r.style + "-value", placeholder: "placeholder" }; var i = this, s = ++t, o = n, u = e(n), a = {}, f = false, l = 0, c, h = false, p; this.id = u.attr("id"); this.val = function (e, t) { if (arguments.length > 0) { A(e, t); return v } else return u.val() }; this.text = function () { return O().find("span." + r.classes.value).text() }; this.change = function () { O().trigger("click.linkselect", [true, true]); return v }; this.focus = function () { setTimeout(function () { v.focus() }, 1); return v }; this.blur = function () { setTimeout(function () { v.blur() }, 1); return v }; this.open = function (t, n) { if (f) return v; e(document).triggerHandler("click.linkselect"); if (n !== false) v.trigger("focus"); setTimeout(function () { R(t) }, 1); return v }; this.disable = function (e) { f = e; v.parent().find("span." + r.classes.disabled).remove(); v[f ? "hide" : "show"](); if (f) v.after('<span class="' + r.classes.disabled + '">' + v.html() + "</span>"); return v }; this.destroy = function () { w.undelegate("li", "*"); v.unbind("*"); x(); v.before(u); d.remove() }; this.replaceOptions = function (t, n, r) { var i = typeof n === "string"; if (!i && !r) r = n; var s = u.children("option"); if (i && n.length) s = s.not(n); s.remove(); e.each(t, function (t) { var n = e("<option/>").attr("value", this.value).html(this.text); if (this.selected == true) n.attr("selected", "selected"); if (this.className) n.addClass(this.className); n.appendTo(u) }); C(); O().trigger("click.linkselect", [true, r]) }; var d = T(); u.after(d).css("visibility", "hidden").css("position", "absolute"); var v = d.filter("a"), m = v.find("> span." + r.classes.linkText), g = d.filter("div"), y = d.find("." + r.classes.scrollable), b = d.find("." + r.classes.title), w = g.find("ul"), E; k(); g.appendTo("body").bind("mousemove.linkselect", function (e) { E = e }); w.delegate("li", "mouseover.linkselect", function (t) { if (E && E.type == "keydown") return; _(e(this)); E = t }).delegate("li", "click.linkselect", function (t, n, s) { t.preventDefault(); var o = O().removeClass(r.classes.selected), a = e(this).addClass(r.classes.selected), l = a.attr("data-value") || "", c = a.find("." + r.classes.value).html(); U(n); u.val(l); R(); if (s !== false && (e.isFunction(r.change) && r.change.apply(i, [this, l, c, s]) === false || e.isFunction(u[0].onchange) && u[0].onchange.apply(i, [this, l, c, s]) === false)) { o.addClass(r.classes.selected); a.removeClass(r.classes.selected); u.val(o.attr("data-value") || ""); return } m.html(c); v[n !== true ? "trigger" : "triggerHandler"]("focus", [n]); try { e(v.attr("href")).valid() } catch (t) { } if (f) v.parent().find("span." + r.classes.disabled).html(c) }); v.bind("click.linkselect", function (e) { e.preventDefault(); I(); setTimeout(function () { v.trigger("focus.linkselect") }, 0) }).bind("focus.linkselect", function (e, t) { if (!g.is(":visible") && t !== true) { v.addClass(r.classes.linkFocus) } }).bind("blur.linkselect", function (e) { if (V(e)) U(); v.removeClass(r.classes.linkFocus) }).bind((e.browser.safari ? "keydown" : "keypress") + ".linkselect", function (e, t) { if (!!t) var e = t; var n = e.keyCode || e.charCode, s = String.fromCharCode(n).toLowerCase(); switch (n) { case 38: case 40: e.preventDefault(); P(n == 38 ? -1 : 1, true); E = e; break; case 13: e.preventDefault(); if (g.is(":visible")) { g.find("li." + r.classes.current).trigger("click.linkselect") } else { v.trigger("click.linkselect") } break; case 9: case 27: U(); break; case 35: e.preventDefault(); j(); E = e; break; case 36: e.preventDefault(); B(); E = e; break; case 33: case 34: e.preventDefault(); var o = g.is(":visible"); if (!o) g.show(); var u = parseInt(y.height() / w.find("li:not(." + r.classes.placeholder + "):first").outerHeight(), 10); if (!o) g.hide(); P(u * (n == 33 ? -1 : 1)); break } if (s != c) l = 0; c = s; if (typeof a[s] != "undefined") { if (l >= a[s].length) l = 0; w.find("#" + i.id + "_li_" + a[s][l]).trigger("click.linkselect"); e.preventDefault(); e.stopPropagation(); l++ } }); if (e.browser.msie) v.bind("keydown.linkselect", function (t) { if (",8,9,33,34,35,36,37,38,39,40,".indexOf("," + t.keyCode + ",") > -1) return e(this).triggerHandler("keypress.linkselect", [t]) }); var q = false; if (e.isFunction(r.init)) r.init.apply(this, [u, v, g, y, b, w]) }; e.LinkSelect.defaults = { style: "linkselect", classLink: "", yAxis: "top", titleAlign: "right", fixedWidth: false, init: null, change: null, format: null, open: null, close: null } })(jQuery)